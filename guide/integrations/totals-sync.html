<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Totals and cart sync with Magento | Vue Storefront</title>
    <meta name="description" content="Headless PWA for eCommerce">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.ca5bf9f5.css" as="style"><link rel="preload" href="/assets/js/app.d8ba6bec.js" as="script"><link rel="preload" href="/assets/js/2.e420855b.js" as="script"><link rel="prefetch" href="/assets/js/10.aad38706.js"><link rel="prefetch" href="/assets/js/11.dbf0cd2d.js"><link rel="prefetch" href="/assets/js/12.8ab12175.js"><link rel="prefetch" href="/assets/js/13.7cddb3f7.js"><link rel="prefetch" href="/assets/js/14.1eec77ed.js"><link rel="prefetch" href="/assets/js/15.79b481f7.js"><link rel="prefetch" href="/assets/js/16.d5958d47.js"><link rel="prefetch" href="/assets/js/17.dad6938c.js"><link rel="prefetch" href="/assets/js/18.16b574f2.js"><link rel="prefetch" href="/assets/js/19.98bf533f.js"><link rel="prefetch" href="/assets/js/20.3befc43a.js"><link rel="prefetch" href="/assets/js/21.5f76b73a.js"><link rel="prefetch" href="/assets/js/22.6ba6e9de.js"><link rel="prefetch" href="/assets/js/23.36cd1220.js"><link rel="prefetch" href="/assets/js/24.bb44e3f8.js"><link rel="prefetch" href="/assets/js/25.ed5e1c93.js"><link rel="prefetch" href="/assets/js/26.c6ce7dd6.js"><link rel="prefetch" href="/assets/js/27.b96d4e19.js"><link rel="prefetch" href="/assets/js/28.1069fe0a.js"><link rel="prefetch" href="/assets/js/29.8c6ca725.js"><link rel="prefetch" href="/assets/js/3.2995eee1.js"><link rel="prefetch" href="/assets/js/30.66e5e0e6.js"><link rel="prefetch" href="/assets/js/31.a5ed2179.js"><link rel="prefetch" href="/assets/js/32.80eacb41.js"><link rel="prefetch" href="/assets/js/33.096aa449.js"><link rel="prefetch" href="/assets/js/34.deb2389a.js"><link rel="prefetch" href="/assets/js/35.5224db0c.js"><link rel="prefetch" href="/assets/js/36.6777a517.js"><link rel="prefetch" href="/assets/js/37.cceecf56.js"><link rel="prefetch" href="/assets/js/38.727d4ca1.js"><link rel="prefetch" href="/assets/js/39.06021a50.js"><link rel="prefetch" href="/assets/js/4.56d2cd4c.js"><link rel="prefetch" href="/assets/js/40.a6db0c7d.js"><link rel="prefetch" href="/assets/js/41.1e93c319.js"><link rel="prefetch" href="/assets/js/42.d7408646.js"><link rel="prefetch" href="/assets/js/43.714cb975.js"><link rel="prefetch" href="/assets/js/44.38aad24b.js"><link rel="prefetch" href="/assets/js/45.2aa6fae9.js"><link rel="prefetch" href="/assets/js/46.ae82a2b4.js"><link rel="prefetch" href="/assets/js/47.4320ee7b.js"><link rel="prefetch" href="/assets/js/48.1f5cc9bd.js"><link rel="prefetch" href="/assets/js/49.d9d92b0f.js"><link rel="prefetch" href="/assets/js/5.468e6e0c.js"><link rel="prefetch" href="/assets/js/50.590c72f3.js"><link rel="prefetch" href="/assets/js/51.84d23438.js"><link rel="prefetch" href="/assets/js/52.46d9a3ae.js"><link rel="prefetch" href="/assets/js/53.2decf3d6.js"><link rel="prefetch" href="/assets/js/54.d6cbd4a4.js"><link rel="prefetch" href="/assets/js/55.3c6ece4b.js"><link rel="prefetch" href="/assets/js/56.74ddfd82.js"><link rel="prefetch" href="/assets/js/57.1401c4b7.js"><link rel="prefetch" href="/assets/js/58.c9baf31f.js"><link rel="prefetch" href="/assets/js/59.aa39857f.js"><link rel="prefetch" href="/assets/js/6.9e714a77.js"><link rel="prefetch" href="/assets/js/60.4a3fb3d3.js"><link rel="prefetch" href="/assets/js/61.78de2281.js"><link rel="prefetch" href="/assets/js/62.abade39a.js"><link rel="prefetch" href="/assets/js/63.3f0ec155.js"><link rel="prefetch" href="/assets/js/64.e9046dd4.js"><link rel="prefetch" href="/assets/js/65.439a44e2.js"><link rel="prefetch" href="/assets/js/66.b8c911b7.js"><link rel="prefetch" href="/assets/js/67.c8004826.js"><link rel="prefetch" href="/assets/js/68.692e58e3.js"><link rel="prefetch" href="/assets/js/69.49751176.js"><link rel="prefetch" href="/assets/js/7.f63a084c.js"><link rel="prefetch" href="/assets/js/70.405beee7.js"><link rel="prefetch" href="/assets/js/8.29152829.js"><link rel="prefetch" href="/assets/js/9.af22b943.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ca5bf9f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vue Storefront</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">Introduction to Vue Storefront</a></li><li><a href="/guide/upgrade-notes/" class="sidebar-link">Upgrade notes</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Installation</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/installation/linux-mac.html" class="sidebar-link">Installing on Linux/MacOS</a></li><li><a href="/guide/installation/windows.html" class="sidebar-link">Installing on Windows</a></li><li><a href="/guide/installation/magento.html" class="sidebar-link">Integration with Magento 2</a></li><li><a href="/guide/installation/production-setup.html" class="sidebar-link">Production setup</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Basics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/basics/release-cycle.html" class="sidebar-link">Release Cycle</a></li><li><a href="/guide/basics/project-structure.html" class="sidebar-link">Project structure</a></li><li><a href="/guide/basics/configuration.html" class="sidebar-link">Configuration file explained</a></li><li><a href="/guide/basics/contributing.html" class="sidebar-link">How to Contribute</a></li><li><a href="/guide/basics/feature-list.html" class="sidebar-link">Feature list</a></li><li><a href="/guide/basics/recipes.html" class="sidebar-link">FAQ and Recipes</a></li><li><a href="/guide/basics/typescript.html" class="sidebar-link">TypeScript Action Plan</a></li><li><a href="/guide/basics/graphql.html" class="sidebar-link">GraphQL Action Plan</a></li><li><a href="/guide/basics/ssr-cache.html" class="sidebar-link">SSR Cache</a></li><li><a href="/guide/basics/amp.html" class="sidebar-link">Google Accelerated Mobile Pages</a></li><li><a href="/guide/basics/e2e.html" class="sidebar-link">E2E tests</a></li><li><a href="/guide/basics/url.html" class="sidebar-link">Custom URL structure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Core and themes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/core-themes/themes.html" class="sidebar-link">Themes in Vue Storefront</a></li><li><a href="/guide/core-themes/layouts.html" class="sidebar-link">Layouts and advanced output operations</a></li><li><a href="/guide/core-themes/core-components.html" class="sidebar-link">Working with core components</a></li><li><a href="/guide/core-themes/ui-store.html" class="sidebar-link">Working with UI Store (Interface state)</a></li><li><a href="/guide/core-themes/translations.html" class="sidebar-link">Internationalization (i18n) of Vue Storefront</a></li><li><a href="/guide/core-themes/service-workers.html" class="sidebar-link">Working with Service Workers</a></li><li><a href="/guide/core-themes/webpack.html" class="sidebar-link">Working with Webpack</a></li><li><a href="/guide/core-themes/plugins.html" class="sidebar-link">Working with plugins</a></li><li><a href="/guide/core-themes/stylesheets.html" class="sidebar-link">Working with stylesheets in the 'default' theme</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Components</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/components/home-page.html" class="sidebar-link">Core Home Page</a></li><li><a href="/guide/components/category-page.html" class="sidebar-link">Core Category Page</a></li><li><a href="/guide/components/product.html" class="sidebar-link">Core Product Page</a></li><li><a href="/guide/components/modal.html" class="sidebar-link">Modal component</a></li><li><a href="/guide/components/events-list.html" class="sidebar-link">Events List</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Data in Vue Storefront</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/data/data.html" class="sidebar-link">Working with data</a></li><li><a href="/guide/data/elasticsearch.html" class="sidebar-link">ElasticSearch data formats</a></li><li><a href="/guide/data/data-migrations.html" class="sidebar-link">Data Migrations for ElacticSearch</a></li><li><a href="/guide/data/elastic-queries.html" class="sidebar-link">ElasticSearch Queries</a></li><li><a href="/guide/data/database-tool.html" class="sidebar-link">Database tool</a></li><li><a href="/guide/data/entity-types.html" class="sidebar-link">Data Entity Types</a></li><li><a href="/guide/data/static-data.html" class="sidebar-link">Static Data support in Vue Storefront</a></li><li><a href="/guide/data/data-loader.html" class="sidebar-link">Async Data Loader</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Extensions</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/extensions/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/extensions/extending-api.html" class="sidebar-link">Extending the API</a></li><li><a href="/guide/extensions/extending-server-side-routes.html" class="sidebar-link">Extending Express.js server side routes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Working with Vuex</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/vuex/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/vuex/vuex-conventions.html" class="sidebar-link">Vuex conventions</a></li><li><a href="/guide/vuex/product-store.html" class="sidebar-link">Product Vuex Store</a></li><li><a href="/guide/vuex/category-store.html" class="sidebar-link">Category Vuex Store</a></li><li><a href="/guide/vuex/stock-store.html" class="sidebar-link">Stock Vuex Store</a></li><li><a href="/guide/vuex/attribute-store.html" class="sidebar-link">Attribute Vuex Store</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Modules</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/modules/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/modules/cart.html" class="sidebar-link">Cart module</a></li><li><a href="/guide/modules/user.html" class="sidebar-link">User Module</a></li><li><a href="/guide/modules/checkout.html" class="sidebar-link">Checkout Module</a></li><li><a href="/guide/modules/order.html" class="sidebar-link">Order module</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Integrations</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/integrations/integrations.html" class="sidebar-link">Existing integrations</a></li><li><a href="/guide/integrations/reviews.html" class="sidebar-link">Product Reviews</a></li><li><a href="/guide/integrations/payment-gateway.html" class="sidebar-link">Payment Gateway Integration</a></li><li><a href="/guide/integrations/paypal-payments.html" class="sidebar-link">PayPal payments support</a></li><li><a href="/guide/integrations/direct-prices-sync.html" class="sidebar-link">Direct prices sync with Magento</a></li><li><a href="/guide/integrations/tier-prices-sync.html" class="sidebar-link">Tier prices sync with Magento</a></li><li><a href="/guide/integrations/totals-sync.html" class="active sidebar-link">Totals and cart sync with Magento</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/integrations/totals-sync.html#cart-and-totals-sync" class="sidebar-link">Cart and Totals sync</a></li><li class="sidebar-sub-header"><a href="/guide/integrations/totals-sync.html#how-to-make-this-feature-work" class="sidebar-link">How to make this feature work?</a></li><li class="sidebar-sub-header"><a href="/guide/integrations/totals-sync.html#prices-sync" class="sidebar-link">Prices sync</a></li><li class="sidebar-sub-header"><a href="/guide/integrations/totals-sync.html#order-sync" class="sidebar-link">Order sync</a></li></ul></li><li><a href="/guide/integrations/multistore.html" class="sidebar-link">Multistore Magento2 support</a></li><li><a href="/guide/integrations/product-reviews.html" class="sidebar-link">Product Reviews</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="totals-and-cart-sync-with-magento"><a href="#totals-and-cart-sync-with-magento" aria-hidden="true" class="header-anchor">#</a> Totals and cart sync with Magento</h1> <p>One of the key principles of the Vue Storefront architecture is afull scalability. We've achieved very good performance results by not relying on the Magento2/CMS API performance. By implementing the &quot;Divide and conquer&quot; rule we created the middleware and external data store for the catalog using ElasticSearch.</p> <p>That was our first goal, but the second was to provide the full data safety and reliability to the business - so we never encounter situations like the stocks and prices are de-synchronized or the discount rules haven't got applied. It can ruin the business, no matter the performance 😃</p> <h2 id="cart-and-totals-sync"><a href="#cart-and-totals-sync" aria-hidden="true" class="header-anchor">#</a> Cart and Totals sync</h2> <p>This is the reason that we've got the direct Shopping cart sync with Magento2. Whenever the user add something to the cart we're checking the stock and synchronize the local in-browser cart with CMS.</p> <p><img src="/assets/img/Vue-storefront-architecture-proxy-requests.c87b9d51.png" alt="This is the dynamic requests architecture"></p> <p>In the backward direction we're always getting the current Totals - after applied Magento shopping cart rules and discounts to display the proper data to the user. This synchronization is implemented to still keep the Vue Storefront platform agnostic - <code>vue-storefront-api</code> layer is in charge of translating the platform specific API formats to the Vue Storefront general data abstraction.</p> <p><img src="/assets/img/cart-sync.6d48833c.png" alt="This is how the cart sync works"></p> <p>As you can see the synchronization works like a sequence of the network calls to the <code>vue-storefront-api</code>:</p> <ol><li>The <code>pull</code> method is executed to get the current user's Magento cart</li> <li>On the client side the logic is checking which elements are new on the client side, server side, removed</li> <li>In our case one element doesn't exist on server side so we're calling an <code>update</code> method to add it to the server cart</li> <li>Then we call <code>totals</code> to get the current row values and general totals for the cart.</li></ol> <h2 id="how-to-make-this-feature-work"><a href="#how-to-make-this-feature-work" aria-hidden="true" class="header-anchor">#</a> How to make this feature work?</h2> <p>By default cart and totals sync is disabled. To make it work You just need to follow the steps described bellow:</p> <ol><li><p>Please generate the Magento2 API accesses. In our first tutorial there is an <a href="/guide/installation/magento.html">explanation on how to do this</a>.</p></li> <li><p>Use the OAuth keys from the previous step to properly configure the <code>vue-storefront-api</code> data layer (it should've been installed locally on your computer / server). To do so you need to modify the <code>conf/local.json</code> and paste the authorization data to the <code>magento2.api</code> section:</p></li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;magento2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://magento2.demo-1.xyz.com&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;imgUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/media/catalog/product&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;magentoUserName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;magentoUserPassword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;httpUserName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;httpUserPassword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://demo-magento2.vuestorefront.io/rest&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;consumerKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;byv3730rhoulpopcq64don8ukb8lf2gq&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;consumerSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;u9q4fcobv7vfx9td80oupa6uhexc27rb&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;040xx3qy7s0j28o3q0exrfop579cy20m&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;accessTokenSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7qunl3p505rubmr7u1ijt7odyialnih9&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Please check the <a href="https://github.com/DivanteLtd/vue-storefront-api/blob/master/config/default.json" target="_blank" rel="noopener noreferrer"><code>conf/default.json</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for the reference.</p> <ol start="3"><li>Then move to your <code>vue-storefront</code> installation catalog and modify the <code>config/local.json</code>. You need to change the <code>cart</code> section to switch the <code>synchronize</code> and <code>synchronize_totals</code> flags to true:</li></ol> <div class="language-json extra-class"><pre class="language-json"><code>   <span class="token property">&quot;cart&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;synchronize&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">&quot;synchronize_totals&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">&quot;create_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/create?token={{token}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;updateitem_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/update?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;deleteitem_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/delete?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pull_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/pull?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;totals_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/totals?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;paymentmethods_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/payment-methods?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;shippingmethods_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/shipping-methods?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;shippinginfo_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/shipping-information?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;collecttotals_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/api/cart/collect-totals?token={{token}}&amp;cartId={{cartId}}&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Please check the <a href="https://github.com/DivanteLtd/vue-storefront/blob/1302ed84561a514beb8c35e45ae1d0aa4dc9f74a/config/default.json#L8" target="_blank" rel="noopener noreferrer"><code>conf/default.json</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for a reference.</p> <h2 id="prices-sync"><a href="#prices-sync" aria-hidden="true" class="header-anchor">#</a> Prices sync</h2> <p>The last missing block is the catalog prices sync. This can be very easily enabled using the feature called Dynamic Prices. Please check <a href="/guide/integrations/direct-prices-sync.html">Dynamic Prices howto</a> to switch this feature on.</p> <h2 id="order-sync"><a href="#order-sync" aria-hidden="true" class="header-anchor">#</a> Order sync</h2> <p>One of the cool features of Vue Storefront is queued order sync. This means whenever user makes and order in the application we store the order in the local browser cache (indexedDb instance) and send it to the server as fast as the Internet connection is available.</p> <p><img src="/assets/img/orders-collection.4c3351a2.png" alt="Orders are stored locally before they're send to the server"></p> <p>On the server side the <code>vue-storefront-api</code> is the first line which the Order is crossing on its way back to Magento2. No matter if the shopping cart was synchronized (as described above) or not the order will be converted to Magento2 object.</p> <p>The server API stores the order in the queue where it's processed by the <a href="https://github.com/DivanteLtd/vue-storefront-api/blob/master/src/worker/order_to_magento2.js" target="_blank" rel="noopener noreferrer"><code>order_2_magento</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> worker process. We do support multiple types of orders: for guest users and logged in, with already synchronized carts or not etc.</p> <p>This process doesn't require much additional configuration:</p> <ol><li>You must have the Magento2 API access configures in the <code>config/local.json</code> file of <code>vue-storefront-api</code></li> <li>You must have the &quot;Orders&quot; section marked On within the &quot;Permissions&quot; section of Magento Integration (<a href="/guide/installation/magento.html">see the previous tutorial for the reference on how to set it up</a>).</li> <li>After the configuration step You just run <code>npm run o2m</code> inside your <code>vue-storefront-api</code> directory.</li></ol> <p><img src="/assets/img/o2m-output.790de781.png" alt="This is the output of o2m after successfull setup"></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/DivanteLtd/vue-storefront/edit/master/docs/guide/integrations/totals-sync.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/integrations/tier-prices-sync.html" class="prev">
          Tier prices sync with Magento
        </a></span> <span class="next"><a href="/guide/integrations/multistore.html">
          Multistore Magento2 support
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/2.e420855b.js" defer></script><script src="/assets/js/app.d8ba6bec.js" defer></script>
  </body>
</html>
