<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Production setup | Vue Storefront</title>
    <meta name="description" content="Headless PWA for eCommerce">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.ca5bf9f5.css" as="style"><link rel="preload" href="/assets/js/app.d8ba6bec.js" as="script"><link rel="preload" href="/assets/js/48.1f5cc9bd.js" as="script"><link rel="prefetch" href="/assets/js/10.aad38706.js"><link rel="prefetch" href="/assets/js/11.dbf0cd2d.js"><link rel="prefetch" href="/assets/js/12.8ab12175.js"><link rel="prefetch" href="/assets/js/13.7cddb3f7.js"><link rel="prefetch" href="/assets/js/14.1eec77ed.js"><link rel="prefetch" href="/assets/js/15.79b481f7.js"><link rel="prefetch" href="/assets/js/16.d5958d47.js"><link rel="prefetch" href="/assets/js/17.dad6938c.js"><link rel="prefetch" href="/assets/js/18.16b574f2.js"><link rel="prefetch" href="/assets/js/19.98bf533f.js"><link rel="prefetch" href="/assets/js/2.e420855b.js"><link rel="prefetch" href="/assets/js/20.3befc43a.js"><link rel="prefetch" href="/assets/js/21.5f76b73a.js"><link rel="prefetch" href="/assets/js/22.6ba6e9de.js"><link rel="prefetch" href="/assets/js/23.36cd1220.js"><link rel="prefetch" href="/assets/js/24.bb44e3f8.js"><link rel="prefetch" href="/assets/js/25.ed5e1c93.js"><link rel="prefetch" href="/assets/js/26.c6ce7dd6.js"><link rel="prefetch" href="/assets/js/27.b96d4e19.js"><link rel="prefetch" href="/assets/js/28.1069fe0a.js"><link rel="prefetch" href="/assets/js/29.8c6ca725.js"><link rel="prefetch" href="/assets/js/3.2995eee1.js"><link rel="prefetch" href="/assets/js/30.66e5e0e6.js"><link rel="prefetch" href="/assets/js/31.a5ed2179.js"><link rel="prefetch" href="/assets/js/32.80eacb41.js"><link rel="prefetch" href="/assets/js/33.096aa449.js"><link rel="prefetch" href="/assets/js/34.deb2389a.js"><link rel="prefetch" href="/assets/js/35.5224db0c.js"><link rel="prefetch" href="/assets/js/36.6777a517.js"><link rel="prefetch" href="/assets/js/37.cceecf56.js"><link rel="prefetch" href="/assets/js/38.727d4ca1.js"><link rel="prefetch" href="/assets/js/39.06021a50.js"><link rel="prefetch" href="/assets/js/4.56d2cd4c.js"><link rel="prefetch" href="/assets/js/40.a6db0c7d.js"><link rel="prefetch" href="/assets/js/41.1e93c319.js"><link rel="prefetch" href="/assets/js/42.d7408646.js"><link rel="prefetch" href="/assets/js/43.714cb975.js"><link rel="prefetch" href="/assets/js/44.38aad24b.js"><link rel="prefetch" href="/assets/js/45.2aa6fae9.js"><link rel="prefetch" href="/assets/js/46.ae82a2b4.js"><link rel="prefetch" href="/assets/js/47.4320ee7b.js"><link rel="prefetch" href="/assets/js/49.d9d92b0f.js"><link rel="prefetch" href="/assets/js/5.468e6e0c.js"><link rel="prefetch" href="/assets/js/50.590c72f3.js"><link rel="prefetch" href="/assets/js/51.84d23438.js"><link rel="prefetch" href="/assets/js/52.46d9a3ae.js"><link rel="prefetch" href="/assets/js/53.2decf3d6.js"><link rel="prefetch" href="/assets/js/54.d6cbd4a4.js"><link rel="prefetch" href="/assets/js/55.3c6ece4b.js"><link rel="prefetch" href="/assets/js/56.74ddfd82.js"><link rel="prefetch" href="/assets/js/57.1401c4b7.js"><link rel="prefetch" href="/assets/js/58.c9baf31f.js"><link rel="prefetch" href="/assets/js/59.aa39857f.js"><link rel="prefetch" href="/assets/js/6.9e714a77.js"><link rel="prefetch" href="/assets/js/60.4a3fb3d3.js"><link rel="prefetch" href="/assets/js/61.78de2281.js"><link rel="prefetch" href="/assets/js/62.abade39a.js"><link rel="prefetch" href="/assets/js/63.3f0ec155.js"><link rel="prefetch" href="/assets/js/64.e9046dd4.js"><link rel="prefetch" href="/assets/js/65.439a44e2.js"><link rel="prefetch" href="/assets/js/66.b8c911b7.js"><link rel="prefetch" href="/assets/js/67.c8004826.js"><link rel="prefetch" href="/assets/js/68.692e58e3.js"><link rel="prefetch" href="/assets/js/69.49751176.js"><link rel="prefetch" href="/assets/js/7.f63a084c.js"><link rel="prefetch" href="/assets/js/70.405beee7.js"><link rel="prefetch" href="/assets/js/8.29152829.js"><link rel="prefetch" href="/assets/js/9.af22b943.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ca5bf9f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vue Storefront</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">Introduction to Vue Storefront</a></li><li><a href="/guide/upgrade-notes/" class="sidebar-link">Upgrade notes</a></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Installation</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/installation/linux-mac.html" class="sidebar-link">Installing on Linux/MacOS</a></li><li><a href="/guide/installation/windows.html" class="sidebar-link">Installing on Windows</a></li><li><a href="/guide/installation/magento.html" class="sidebar-link">Integration with Magento 2</a></li><li><a href="/guide/installation/production-setup.html" class="active sidebar-link">Production setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/installation/production-setup.html#production-setup-bare-vps" class="sidebar-link">Production setup - bare VPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/installation/production-setup.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/guide/installation/production-setup.html#nginx" class="sidebar-link">Nginx</a></li><li class="sidebar-sub-header"><a href="/guide/installation/production-setup.html#vue-storefront-and-vue-storefront-api" class="sidebar-link">Vue Storefront and Vue Storefront API</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/installation/production-setup.html#production-setup-using-docker-kubernetes" class="sidebar-link">Production setup - using Docker / Kubernetes</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Basics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/basics/release-cycle.html" class="sidebar-link">Release Cycle</a></li><li><a href="/guide/basics/project-structure.html" class="sidebar-link">Project structure</a></li><li><a href="/guide/basics/configuration.html" class="sidebar-link">Configuration file explained</a></li><li><a href="/guide/basics/contributing.html" class="sidebar-link">How to Contribute</a></li><li><a href="/guide/basics/feature-list.html" class="sidebar-link">Feature list</a></li><li><a href="/guide/basics/recipes.html" class="sidebar-link">FAQ and Recipes</a></li><li><a href="/guide/basics/typescript.html" class="sidebar-link">TypeScript Action Plan</a></li><li><a href="/guide/basics/graphql.html" class="sidebar-link">GraphQL Action Plan</a></li><li><a href="/guide/basics/ssr-cache.html" class="sidebar-link">SSR Cache</a></li><li><a href="/guide/basics/amp.html" class="sidebar-link">Google Accelerated Mobile Pages</a></li><li><a href="/guide/basics/e2e.html" class="sidebar-link">E2E tests</a></li><li><a href="/guide/basics/url.html" class="sidebar-link">Custom URL structure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Core and themes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/core-themes/themes.html" class="sidebar-link">Themes in Vue Storefront</a></li><li><a href="/guide/core-themes/layouts.html" class="sidebar-link">Layouts and advanced output operations</a></li><li><a href="/guide/core-themes/core-components.html" class="sidebar-link">Working with core components</a></li><li><a href="/guide/core-themes/ui-store.html" class="sidebar-link">Working with UI Store (Interface state)</a></li><li><a href="/guide/core-themes/translations.html" class="sidebar-link">Internationalization (i18n) of Vue Storefront</a></li><li><a href="/guide/core-themes/service-workers.html" class="sidebar-link">Working with Service Workers</a></li><li><a href="/guide/core-themes/webpack.html" class="sidebar-link">Working with Webpack</a></li><li><a href="/guide/core-themes/plugins.html" class="sidebar-link">Working with plugins</a></li><li><a href="/guide/core-themes/stylesheets.html" class="sidebar-link">Working with stylesheets in the 'default' theme</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Components</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/components/home-page.html" class="sidebar-link">Core Home Page</a></li><li><a href="/guide/components/category-page.html" class="sidebar-link">Core Category Page</a></li><li><a href="/guide/components/product.html" class="sidebar-link">Core Product Page</a></li><li><a href="/guide/components/modal.html" class="sidebar-link">Modal component</a></li><li><a href="/guide/components/events-list.html" class="sidebar-link">Events List</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Data in Vue Storefront</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/data/data.html" class="sidebar-link">Working with data</a></li><li><a href="/guide/data/elasticsearch.html" class="sidebar-link">ElasticSearch data formats</a></li><li><a href="/guide/data/data-migrations.html" class="sidebar-link">Data Migrations for ElacticSearch</a></li><li><a href="/guide/data/elastic-queries.html" class="sidebar-link">ElasticSearch Queries</a></li><li><a href="/guide/data/database-tool.html" class="sidebar-link">Database tool</a></li><li><a href="/guide/data/entity-types.html" class="sidebar-link">Data Entity Types</a></li><li><a href="/guide/data/static-data.html" class="sidebar-link">Static Data support in Vue Storefront</a></li><li><a href="/guide/data/data-loader.html" class="sidebar-link">Async Data Loader</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Extensions</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/extensions/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/extensions/extending-api.html" class="sidebar-link">Extending the API</a></li><li><a href="/guide/extensions/extending-server-side-routes.html" class="sidebar-link">Extending Express.js server side routes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Working with Vuex</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/vuex/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/vuex/vuex-conventions.html" class="sidebar-link">Vuex conventions</a></li><li><a href="/guide/vuex/product-store.html" class="sidebar-link">Product Vuex Store</a></li><li><a href="/guide/vuex/category-store.html" class="sidebar-link">Category Vuex Store</a></li><li><a href="/guide/vuex/stock-store.html" class="sidebar-link">Stock Vuex Store</a></li><li><a href="/guide/vuex/attribute-store.html" class="sidebar-link">Attribute Vuex Store</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Modules</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/modules/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/modules/cart.html" class="sidebar-link">Cart module</a></li><li><a href="/guide/modules/user.html" class="sidebar-link">User Module</a></li><li><a href="/guide/modules/checkout.html" class="sidebar-link">Checkout Module</a></li><li><a href="/guide/modules/order.html" class="sidebar-link">Order module</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Integrations</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/integrations/integrations.html" class="sidebar-link">Existing integrations</a></li><li><a href="/guide/integrations/reviews.html" class="sidebar-link">Product Reviews</a></li><li><a href="/guide/integrations/payment-gateway.html" class="sidebar-link">Payment Gateway Integration</a></li><li><a href="/guide/integrations/paypal-payments.html" class="sidebar-link">PayPal payments support</a></li><li><a href="/guide/integrations/direct-prices-sync.html" class="sidebar-link">Direct prices sync with Magento</a></li><li><a href="/guide/integrations/tier-prices-sync.html" class="sidebar-link">Tier prices sync with Magento</a></li><li><a href="/guide/integrations/totals-sync.html" class="sidebar-link">Totals and cart sync with Magento</a></li><li><a href="/guide/integrations/multistore.html" class="sidebar-link">Multistore Magento2 support</a></li><li><a href="/guide/integrations/product-reviews.html" class="sidebar-link">Product Reviews</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="production-setup"><a href="#production-setup" aria-hidden="true" class="header-anchor">#</a> Production setup</h1> <p>If you like to start developing sites using Vue Storefront, probably you need to start with the <a href="/guide/installation/linux-mac.html">Installation guide</a>. For the development purposes you'll probably be using <code>yarn install</code> / <code>npm run installer</code> sequence which will setup Vue Storefront locally using the automated installer and prepared Docker images for having Elastic Search and Redis support.</p> <p>Development mode means you're using node.js based server as HTTP service and running the app on the <code>3000</code> TCP port. As it's great for local testing it's <strong>not recommended</strong> to use installer and direct user access to node.js in production configurations.</p> <h2 id="production-setup-bare-vps"><a href="#production-setup-bare-vps" aria-hidden="true" class="header-anchor">#</a> Production setup - bare VPS</h2> <p>To run Vue Storefront in the production mode without Docker/Kubernetes you'll need the Virtual Private Server with <code>root</code> access (for the setup purposes). We assume that you're using <code>Debian GNU Linux</code> in the following steps.</p> <p>Assumptions for the rest of this tutorial:</p> <ul><li>You're having root access to Debian Linux machine;</li> <li>We'll be using the default local ports <code>3000</code> for <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer"><code>vue-storefront</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <code>8080</code> for <a href="https://github.com/DivanteLtd/vue-storefront-api" target="_blank" rel="noopener noreferrer"><code>vue-storefront-api</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>; the ports <strong>should not be exposed</strong> as they will be hidden behind <strong>NGINX proxy</strong>;</li> <li>We're using <strong>prod.vuestorefront.io</strong> as a domain name - please replace it with your host URL address;</li> <li>We assume that you have SSL certificate for <strong>prod.vuestorefront.io</strong> (or your domain of course). SSL encryption is required for PWA + service workers;</li></ul> <p>General Solution Architecture:
<em>USER -&gt; NGINX proxy -&gt; vue-storefront / vue-storefront-api</em></p> <p>We'll be hiding the <code>vue-storefront</code> and <code>vue-storefront-api</code> services behind NGINX proxy. You can use NGINX for caching proxy, but in our case it will be just forwarding the requests without cache (as VS is pretty fast and caching is not required). The key features we're using are: SSL encryption, gzip-encoding, url routing (to merge <code>vue-storefront</code> and <code>vue-storefront-api</code> services under one domain).</p> <h3 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h3> <p>Vue Storefront requires <strong>Elastic Search</strong> and the <strong>Redis server</strong> installed. By default, in the development mode, both dependencies are provided with the <code>docker-compose.yml</code> Docker images. However, for the production purposes we recommend to install the servers natively.</p> <p>For the purposes of this tutorial we will use default packages distributed along with the Debian operating systems, without any security hardening, config hardening operations.</p> <p><strong>Please make sure</strong> that your security/devops team have taken a look at the configs you're using and do harden the server configuration before launching your app publicly!</p> <p>First, let's create the user (as root user):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> /home/www
<span class="token function">useradd</span> -m -d /home/www/vuestorefront vuestorefront
</code></pre></div><p>Then install the Elasticsearch and Redis (as root user):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">apt-get</span> update
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">curl</span>
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span>

<span class="token function">curl</span> -sL https://deb.nodesource.com/setup_8.x <span class="token operator">|</span> <span class="token function">bash</span> -
<span class="token function">apt-get</span> <span class="token function">install</span> -y nodejs
<span class="token function">npm</span> <span class="token function">install</span> -g yarn

<span class="token function">apt-get</span> <span class="token function">install</span> redis-server

<span class="token function">apt-get</span> <span class="token function">install</span> openjdk-8-jre
<span class="token function">curl</span> -L -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.6.9.deb
dpkg -i elasticsearch-5.6.9.deb
/etc/init.d/elasticsearch start

<span class="token function">apt-get</span> <span class="token function">install</span> imagemagick
<span class="token function">apt-get</span> <span class="token function">install</span> nginx
</code></pre></div><h3 id="nginx"><a href="#nginx" aria-hidden="true" class="header-anchor">#</a> Nginx</h3> <p>We decided to use <strong>NGINX</strong> as a HTTP proxy - exposed in front of the users, handling the network traffic and dealing with the <code>vue-storefront</code> and the <code>vue-storefront-api</code> apps as a backend.</p> <p>This is a general rule of setting up a production node.js app which gives you a lot of flexibility regarding the SSL, gzip compression, URL routing and other techniques to be configured without additional hassle. You can use any other proxy server for this purpose - such as Varnish or Apache2 + mod_proxy.</p> <p>Some additional materials:</p> <ul><li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-16-04" target="_blank" rel="noopener noreferrer">How to setup production node.js app in the Digital Ocean environment (Ubuntu 16)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/" target="_blank" rel="noopener noreferrer">How to setup nginx reverse proxy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="nginx-configuration"><a href="#nginx-configuration" aria-hidden="true" class="header-anchor">#</a> Nginx configuration</h4> <p><a href="https://github.com/DivanteLtd/vue-storefront/tree/master/docs/guide/installation/etc/nginx/sites-enabled/prod.vuestorefront.io" target="_blank" rel="noopener noreferrer">Here is the complete <code>/etc/nginx/sites-enabled/prod.vuestorefront.io</code> file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Create NGINX config file from the template (please run as a root user):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://raw.githubusercontent.com/DivanteLtd/vue-storefront/develop/docs/guide/installation/prod.vuestorefront.io <span class="token operator">&gt;</span> /etc/nginx/sites-available/prod.vuestorefront.io
<span class="token function">ln</span> -s /etc/nginx/sites-available/prod.vuestorefront.io /etc/nginx/sites-enabled/prod.vuestorefront.io
</code></pre></div><p><strong>Install the SSL certificate</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> /etc/nginx/ssl
<span class="token function">nano</span> /etc/nginx/ssl/prod.vuestorefront.io.chained.crt
<span class="token function">nano</span> /etc/nginx/ssl/prod.vuestorefront.io.key
<span class="token function">nano</span> /etc/nginx/ssl/dhparam.pem
</code></pre></div><p>Now you can run the NGINX:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>/etc/init.d/nginx restart
</code></pre></div><p>Please find the full comments on the following sections of the file below:</p> <div class="language-js extra-class"><pre class="language-js"><code>server <span class="token punctuation">{</span>
	listen <span class="token number">80</span><span class="token punctuation">;</span>
	server_name prod<span class="token punctuation">.</span>vuestorefront<span class="token punctuation">.</span>io<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">301</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>prod<span class="token punctuation">.</span>vuestorefront<span class="token punctuation">.</span>io$request_uri<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This section runs the standard http://prod.vuestorefront.io and creates a wildcard redirect from http://prod.vuestorefront.io/* -&gt; https://prod.vuestorefront.io/. SSL secured connection is a must for run PWA and use service-workers.</p> <div class="language-js extra-class"><pre class="language-js"><code>server <span class="token punctuation">{</span>
	listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>
	server_name prod<span class="token punctuation">.</span>vuestorefront<span class="token punctuation">.</span>io http2<span class="token punctuation">;</span>

	ssl on<span class="token punctuation">;</span>
</code></pre></div><p>We're using <code>http2</code> but it's not required. This section is for setting up the SSL secured virtual host of Vue Storefront frontend.</p> <div class="language- extra-class"><pre class="language-text"><code>ssl_certificate /etc/nginx/ssl/prod.vuestorefront.io.chained.crt;
ssl_certificate_key /etc/nginx/ssl/prod.vuestorefront.io.key;
</code></pre></div><p>We assume that the certificate related files are stored in the <code>/etc/nginx/ssl/</code>. Please point it to your certificate files.</p> <div class="language- extra-class"><pre class="language-text"><code>ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
ssl_prefer_server_ciphers on;
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA;
ssl_ecdh_curve secp384r1;
ssl_session_timeout 10m;
ssl_session_cache shared:SSL:10m;
ssl_session_tickets off;
ssl_stapling on;
ssl_stapling_verify on;
resolver 8.8.8.8 8.8.4.4 valid=300s;
resolver_timeout 5s;

ssl_dhparam /etc/nginx/ssl/dhparam.pem;

add_header Strict-Transport-Security &quot;max-age=31536000&quot; always;
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection &quot;1; mode=block&quot;;
add_header X-Robots-Tag none;
</code></pre></div><p>Here we go with the SSL settings - based on our best experiences from the past. Please read details in the <a href="http://nginx.org/en/docs/http/configuring_https_servers.html" target="_blank" rel="noopener noreferrer">NGINX documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if you like 😉</p> <div class="language- extra-class"><pre class="language-text"><code>gzip on;
gzip_proxied any;
gzip_types
  text/css
  text/javascript
  text/xml
  application/javascript
  application/json
  text/json
  text/html;
}
</code></pre></div><p>Vue Storefront SSR responses contain the full markup + JSON objects included for speed-up the first page view. Unfortunately - among with significant JS bundle sizes - it can generate a significant network load. We're optimizing it with using gzip compression server side.</p> <div class="language- extra-class"><pre class="language-text"><code>location / {
  proxy_pass http://localhost:3000/;
}
</code></pre></div><p>We're using <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html" target="_blank" rel="noopener noreferrer"><code>proxy_pass</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from the <code>ngx_http_proxy_module</code> to pull the content from the Vue Storefront nodejs server. Site will be available under https://prod.vuestorefront.io/</p> <div class="language- extra-class"><pre class="language-text"><code>location /assets/ {
  proxy_pass http://localhost:3000/assets/;
}
</code></pre></div><p>The same module is used for providing user with the static assets. Assets will be available under: https://prod.vuestorefront.io/assets</p> <div class="language- extra-class"><pre class="language-text"><code>location /api/ {
  proxy_pass http://localhost:8080/api/;
}
</code></pre></div><p>The next proxy section is used for serving the API. It's a proxy to <a href="https://github.com/DivanteLtd/vue-storefront-api" target="_blank" rel="noopener noreferrer"><code>vue-storefront-api</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> app running on <code>8080</code> port (default config). API will be available under: https://prod.vuestorefront.io/api</p> <div class="language- extra-class"><pre class="language-text"><code>location /img/ {
  proxy_pass http://localhost:8080/img/;
}
</code></pre></div><p>The last proxy is used for serving product images. It's a proxy to <a href="https://github.com/DivanteLtd/vue-storefront-api" target="_blank" rel="noopener noreferrer"><code>vue-storefront-api</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> app running on <code>8080</code> port (default config). Images will be available under: https://prod.vuestorefront.io/img</p> <h4 id="apache2-configuration"><a href="#apache2-configuration" aria-hidden="true" class="header-anchor">#</a> Apache2 configuration</h4> <p>In case you are already using the apache2 web-server in your environment as well and can't (or don't want) to use NGINX, you can also set up apache2 as an reverse proxy instead of nginx. This is done by adding this block to your apache2 virtual host.</p> <div class="language- extra-class"><pre class="language-text"><code>ProxyRequests off

ProxyPass /api/ http://localhost:8080/api/
ProxyPassReverse /api http://localhost:8080/api/

ProxyPass /img/ http://localhost:8080/img/
ProxyPassReverse /img http://localhost:8080/img/

ProxyPass /assets/ http://localhost:3000/assets/
ProxyPassReverse /assets http://localhost:3000/assets/

ProxyPass / http://localhost:3000/
ProxyPassReverse / http://localhost:3000/
</code></pre></div><p>You also need to enable <a href="https://httpd.apache.org/docs/current/mod/mod_proxy.html" target="_blank" rel="noopener noreferrer">mod_proxy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for this.</p> <h3 id="vue-storefront-and-vue-storefront-api"><a href="#vue-storefront-and-vue-storefront-api" aria-hidden="true" class="header-anchor">#</a> Vue Storefront and Vue Storefront API</h3> <p>After you have the NGINX set up, you should get a <code>502 error</code> when accessing the https://prod.vuestorefront.io. This is totally fine! We've just missed the most important step which is running backend services that will power up our installation. Now nginx is trying to connect to <code>localhost:3000</code> for <code>vue-storefront</code> and <code>localhost:8080</code> for <code>vue-storefront-api</code> without any success.</p> <p>We create a Linux user called <code>vuestorefront</code> and go to <code>/home/www/vuestorefront</code> which is our home directory.</p> <p>You need to clone the <code>vue-storefront</code> and the <code>vue-storefront-api</code> repos accordingly with the following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">su</span> vuestorefront
<span class="token function">cd</span> /home/www/vuestorefront
<span class="token function">git</span> clone https://github.com/DivanteLtd/vue-storefront.git
<span class="token function">git</span> clone https://github.com/DivanteLtd/vue-storefront-api.git
</code></pre></div><p>Then you will need to install the required node packages:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> /home/www/vuestorefront/vue-storefront-api
yarn <span class="token function">install</span>
</code></pre></div><p>... and ...</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> /home/www/vuestorefront/vue-storefront
yarn <span class="token function">install</span>
</code></pre></div><p>It may take a few minutes. Once the modules are installed we can set configuration files for both services.</p> <h4 id="vue-storefront-configuration"><a href="#vue-storefront-configuration" aria-hidden="true" class="header-anchor">#</a> Vue Storefront configuration</h4> <p>The full configuration files are available here to download: <a href="https://github.com/DivanteLtd/vue-storefront/blob/develop/docs/guide/installation/vue-storefront/config" target="_blank" rel="noopener noreferrer">vue-storefront<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/DivanteLtd/vue-storefront/blob/develop/docs/guide/installation/vue-storefront-api/config" target="_blank" rel="noopener noreferrer">vue-storefront-api<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Please create the <code>vue-storefront-api/config/local.json</code> and <code>vue-storefront/config/local.json</code> files accordingly.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://raw.githubusercontent.com/DivanteLtd/vue-storefront/develop/docs/guide/installation/vue-storefront-api/config/local.json <span class="token operator">&gt;</span> /home/www/vuestorefront/vue-storefront-api/config/local.json
</code></pre></div><p>... and ...</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://raw.githubusercontent.com/DivanteLtd/vue-storefront/develop/docs/guide/installation/vue-storefront/config/local.json <span class="token operator">&gt;</span> /home/www/vuestorefront/vue-storefront/config/local.json
</code></pre></div><p>Please find the key sections of the <code>vue-storefront/config/local.json</code> file described in below:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;elasticsearch&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;httpAuth&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/catalog&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue_storefront_catalog&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">&quot;storeViews&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;mapStoreUrlsFor&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;de&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;it&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;multistore&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;de&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;disabled&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;elasticsearch&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;httpAuth&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/catalog&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue_storefront_catalog_de&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;it&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;disabled&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;elasticsearch&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;httpAuth&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/catalog&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue_storefront_catalog_it&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>We're setting up the product's endpoint to https://prod.vuestorefront.io/api/catalog (please use your domain accordingly of course). As you may notice, the <code>/api</code> url is proxied by the NGINX to <code>localhost:8080</code> - our <code>vue-storefront-api</code> instance.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;cart&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;synchronize&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;synchronize_totals&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;create_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/create?token={{token}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;updateitem_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/update?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;deleteitem_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/delete?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pull_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/pull?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;totals_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/totals?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;paymentmethods_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/payment-methods?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;shippingmethods_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/shipping-methods?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;shippinginfo_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/shipping-information?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;collecttotals_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/collect-totals?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;deletecoupon_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/delete-coupon?token={{token}}&amp;cartId={{cartId}}&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;applycoupon_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://prod.vuestorefront.io/api/cart/apply-coupon?token={{token}}&amp;cartId={{cartId}}&amp;coupon={{coupon}}&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>There are 27 more instances of <code>prod.vuestorefront.io</code> to be replaced with your production URL address in this file - please just do so 😃</p> <h4 id="vue-storefront-api-configuration"><a href="#vue-storefront-api-configuration" aria-hidden="true" class="header-anchor">#</a> Vue Storefront API configuration</h4> <p>The <a href="https://github.com/DivanteLtd/vue-storefront/blob/develop/docs/guide/installation/vue-storefront-api/config" target="_blank" rel="noopener noreferrer">provided vue-storefront-api configuration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> requires almost no changes.</p> <p>The only lines you need to alter are:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;imageable&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;namespace&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;maxListeners&quot;</span><span class="token operator">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
    <span class="token property">&quot;imageSizeLimit&quot;</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timeouts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;convert&quot;</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
        <span class="token property">&quot;identify&quot;</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
        <span class="token property">&quot;download&quot;</span><span class="token operator">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;whitelist&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;allowedHosts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;.*divante.pl&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;.*vuestorefront.io&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;trustedHosts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;.*divante.pl&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;.*vuestorefront.io&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;keepDownloads&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;maxDownloadCacheSize&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tmpPathRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/tmp&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">&quot;elasticsearch&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9200&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indices&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;vue_storefront_catalog&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;vue_storefront_catalog_it&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;vue_storefront_catalog_de&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You should put here the <code>allowedHosts</code> and <code>trustedHosts</code> for the Imageable - to download the product images. The domain name points to the <strong>Magento2</strong> instance where images are sourced. In this example Magento2 is running under <strong>http://demo-magento2.vuestorefront.io</strong>.</p> <h4 id="using-your-own-magento2-instance"><a href="#using-your-own-magento2-instance" aria-hidden="true" class="header-anchor">#</a> Using your own magento2 instance</h4> <p>In this case you'll have to update <code>magento2</code> config node with correct hostname in vue-storefront-api config file. To get all necessary Magento2 API data for <code>api</code> node, navigate to SYSTEM -&gt; Extensions -&gt; Integrations in Magento2 Admin.</p> <ul><li>click Add new integration</li> <li>check the necessary permissions (check Catalog, Sales, My Account and Carts on API permissions tab )</li> <li>click Activate</li> <li>copy necessary keys, secrets and tokens into <code>api</code> section of vue-storefront-api config</li></ul> <h4 id="build-vs"><a href="#build-vs" aria-hidden="true" class="header-anchor">#</a> Build VS</h4> <p>Before we can run Vue Storefront and Vue Storefront API we should build it in the production mode. To do so please just execute the following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> /home/www/vuestorefront/vue-storefront/
yarn build
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> /home/www/vuestorefront/vue-storefront-api/
yarn build
</code></pre></div><h4 id="data-import"><a href="#data-import" aria-hidden="true" class="header-anchor">#</a> Data import</h4> <p>Vue Storefront needs to have some data in the ElasticSearch to properly display products and categories. Of course you can install <a href="https://github.com/DivanteLtd/mage2vuestorefront" target="_blank" rel="noopener noreferrer">mage2vuestorefront<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and configure the data pump to synchronize and update the ElasticSearch index whenever data is being changed in Magento. For purposes of this tutorial we'll just restore the data from the JSON file.</p> <p>You can easily dump your current VS index using the following command (your local installation):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> vue-storefront-api
<span class="token function">rm</span> var/catalog.json
<span class="token function">npm</span> run dump
</code></pre></div><p>Now in the <code>var/catalog.json</code> you have your current database dump. Please transfer this file to the server for example using the following ssh command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> vuestorefront@prod.vuestorefront.io <span class="token function">rm</span> ~/vue-storefront-api/var/catalog.json
<span class="token function">scp</span> vue-storefront-api/var/catalog.json vuestorefront@prod.vuestorefront.io:~/vue-storefront-api/var/catalog.json
</code></pre></div><p>Then, after logging in to your <code>prod.vuestorefront.io</code> server as a <code>vuestorefront</code> you can run the following command to import the data:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> vue-storefront-api
<span class="token function">npm</span> run db new
<span class="token function">npm</span> run restore2main
<span class="token function">npm</span> run db rebuild
</code></pre></div><h4 id="running-the-vue-storefront-and-vue-storefront-api"><a href="#running-the-vue-storefront-and-vue-storefront-api" aria-hidden="true" class="header-anchor">#</a> Running the Vue Storefront and Vue Storefront API</h4> <p>After everything set, you can just start the <code>vue-storefront</code> and <code>vue-storefront-api</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> vue-storefront-api
yarn start
<span class="token function">cd</span> vue-storefront
yarn start
</code></pre></div><p>Both applications use <a href="https://pm2.io/runtime" target="_blank" rel="noopener noreferrer"><code>PM2</code> process manager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the production mode (<code>start</code> commands) to manage and respawn the nodejs processes when needed.</p> <h2 id="production-setup-using-docker-kubernetes"><a href="#production-setup-using-docker-kubernetes" aria-hidden="true" class="header-anchor">#</a> Production setup - using Docker / Kubernetes</h2> <p>To be prepared.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/DivanteLtd/vue-storefront/edit/master/docs/guide/installation/production-setup.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/installation/magento.html" class="prev">
          Integration with Magento 2
        </a></span> <span class="next"><a href="/guide/basics/release-cycle.html">
          Release Cycle
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/48.1f5cc9bd.js" defer></script><script src="/assets/js/app.d8ba6bec.js" defer></script>
  </body>
</html>
